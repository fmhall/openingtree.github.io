(this["webpackJsonpopening-prep"]=this["webpackJsonpopening-prep"]||[]).push([[0],{316:function(e,t,a){e.exports=a(595)},386:function(e,t){},388:function(e,t){},420:function(e,t){},421:function(e,t){},487:function(e,t){},595:function(e,t,a){"use strict";a.r(t);var n,s=a(21),r=a.n(s),o=a(13),i=a(16),l=a(26),c=a(27),u=a(57),h=a(29),m=a(0),p=a.n(m),d=a(85),g=a.n(d),f=a(280),v=a.n(f),b=(a(331),"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"),y=a(17),E=["ultraBullet","bullet","blitz","rapid","classical","correspondence"],w=["bullet","blitz","rapid","daily"],C=(n={},Object(y.a)(n,"ultraBullet","Ultrabullet"),Object(y.a)(n,"bullet","Bullet"),Object(y.a)(n,"blitz","Blitz"),Object(y.a)(n,"rapid","Rapid"),Object(y.a)(n,"classical","Classical"),Object(y.a)(n,"correspondence","Correspondence"),Object(y.a)(n,"daily","Daily"),n),k={100:800,99:677,98:589,97:538,96:501,95:470,94:444,93:422,92:401,91:383,90:366,89:351,88:336,87:322,86:309,85:296,84:284,83:273,82:262,81:251,80:240,79:230,78:220,77:211,76:202,75:193,74:184,73:175,72:166,71:158,70:149,69:141,68:133,67:125,66:117,65:110,64:102,63:95,62:87,61:80,60:72,59:65,58:57,57:50,56:43,55:36,54:29,53:21,52:14,51:7,50:0,49:-7,48:-14,47:-21,46:-29,45:-36,44:-43,43:-50,42:-57,41:-65,40:-72,39:-80,38:-87,37:-95,36:-102,35:-110,34:-117,33:-125,32:-133,31:-141,30:-149,29:-158,28:-166,27:-175,26:-184,25:-193,24:-202,23:-211,22:-220,21:-230,20:-240,19:-251,18:-262,17:-273,16:-284,15:-296,14:-309,13:-322,12:-336,11:-351,10:-366,9:-383,8:-401,7:-422,6:-444,5:-470,4:-501,3:-538,2:-589,1:-677,0:-800};function N(e,t){var a={};return t.forEach((function(t){a[t]=e[t]})),a}function O(e){var t=e.split(" ");return t.length<=4?e:"".concat(t[0]," ").concat(t[1]," ").concat(t[2])}function S(e,t,a){return("lichess"===e?E:w).filter((function(e){return!!t[e]===a}))}var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){for(var e=[{year:2007,value:0}],t=1,a=2010,n=(new Date).getFullYear(),s=(new Date).getMonth();a<n-1;)e.push({toLongLabel:"".concat(F[11]," ").concat(a),fromLongLabel:"".concat(F[0]," ").concat(a),year:a,value:t}),a++,t++;for(var r=11;r>0;r--){var o=(s+12-r)%12,i=o<s?n:n-1;e.push({fromLongLabel:"".concat(F[o]," ").concat(i),toLongLabel:"".concat(F[o]," ").concat(i),month:o,year:i,value:t}),t++}return e.push({month:12,year:n,value:t}),e}function P(e,t){var a=e[0],n=e[1],s=t[a],r=t[n];if(a===t.length-1&&n===t.length-1){var o=new Date;return{label:"Current month",fromMonth:o.getMonth(),frmYear:o.getYear(),fromTimeStamp:x(o.getMonth(),o.getYear(),"min")}}if(0===a&&0===n)return{label:"Anytime"};if(0===a&&n===t.length-1)return{label:"Anytime"};if(n===t.length-1){var i=s.month?s.month:0;return{label:"Since ".concat(s.fromLongLabel),fromYear:s.year,fromMonth:i,fromTimeStamp:x(i,s.year,"min")}}if(0===a){var l=r.month?r.month:11;return{label:"Until ".concat(r.toLongLabel),toYear:r.year,toMonth:l,toTimeStamp:x(l,r.year,"max")}}var c=s.month?s.month:0,u=r.month?r.month:11;return{label:"From ".concat(s.fromLongLabel," to ").concat(r.toLongLabel),fromYear:s.year,fromMonth:c,fromTimeStamp:x(c,s.year,"min"),toYear:r.year,toMonth:u,toTimeStamp:x(u,r.year,"max")}}function x(e,t,a){return"min"===a?new Date(t,e).getTime():new Date(t,e,function(e,t){return new Date(e,t+1,0).getDate()}(t,e)).getTime()}function j(e,t){return(3e3===t[1]||e<=t[1])&&e>=t[0]}var R=function(){function e(){Object(o.a)(this,e),this.graph=new A}return Object(i.a)(e,[{key:"clear",value:function(){this.graph=new A}},{key:"addGameResultOnFen",value:function(e,t){this.getNodeFromGraph(e).gameResults.push(t)}},{key:"addResultToRoot",value:function(e,t){var a=this.getNodeFromGraph(b),n=this.getUpdatedMoveDetails(a.details,e,t);a.details=n}},{key:"getDetailsForFen",value:function(e){return this.getNodeFromGraph(O(e)).details}},{key:"addMoveForFen",value:function(e,t,a,n,s){var r=this.getNodeFromGraph(t),o=this.getUpdatedMoveDetails(r.details,n,s);r.details=o;var i=this.getNodeFromGraph(e),l=this.createOrGetMoveNode(i.playedBy,a,t);i.playedByMax=Math.max(i.playedByMax,r.details.count),i.playedBy=l}},{key:"getNodeFromGraph",value:function(e){var t=O(e),a=this.graph.nodes.get(t);return a||((a=new M).fen=t,this.graph.nodes.set(t,a)),a}},{key:"createOrGetMoveNode",value:function(e,t,a){var n=e.get(t.san);return n||((n=new G).move=t,n.fen=O(a),e.set(t.san,n)),e}},{key:"getUpdatedMoveDetails",value:function(e,t,a){var n,s,r=0,o=0,i=0,l=0,c=0;return"1-0"===t.result?(r=1,c="white"===a?1:-1):"0-1"===t.result?(o=1,c="black"===a?1:-1):i=1,l="white"===a?t.blackElo:t.whiteElo,1===c&&(!e.bestWin||parseInt(l)>parseInt(e.bestWin))&&(e.bestWin=l,e.bestWinGame=t),-1===c&&(!e.worstLoss||parseInt(l)<parseInt(e.worstLoss))&&(e.worstLoss=l,e.worstLossGame=t),e.lastPlayedGame&&(n=t.date,!(s=e.lastPlayedGame.date)||n&&!(new Date(n)>new Date(s)))||(e.lastPlayedGame=t),e.count+=1,e.blackWins+=o,e.whiteWins+=r,e.draws+=i,e.totalOpponentElo+=parseInt(l),e}},{key:"gameResultsForFen",value:function(e){var t=O(e),a=this.graph.nodes.get(t);return a?a.gameResults:null}},{key:"movesForFen",value:function(e){var t=this,a=O(e),n=this.graph.nodes.get(a);return n?Array.from(n.playedBy.entries()).map((function(e){var a=e[1],s=t.graph.nodes.get(a.fen);return{orig:a.move.from,dest:a.move.to,level:t.levelFor(s.details.count,n.playedByMax),san:a.move.san,details:s.details}})):null}},{key:"levelFor",value:function(e,t){return t<=0||e/t>.8?2:e/t>.3?1:0}}]),e}(),A=function e(){Object(o.a)(this,e),this.nodes=new Map},M=function e(){Object(o.a)(this,e),this.fen="",this.playedByMax=0,this.playedBy=new Map,this.gameResults=[],this.properties={},this.details={count:0,blackWins:0,whiteWins:0,draws:0,totalOpponentElo:0,bestWin:null,bestWinGame:null,worstLoss:null,worstLossGame:null,lastPlayedGame:null}},G=function e(){Object(o.a)(this,e),this.fen="",this.move={}};var D=new R,L=a(282),B=a.n(L),I=a(49),W=function(){function e(){Object(o.a)(this,e),this.plys=[{pgn:"",fen:b,move:null}],this.currentIndex=0}return Object(i.a)(e,[{key:"addPly",value:function(e,t){if(!(this.currentIndex<this.plys.length-1&&this.plys[this.currentIndex+1].move.san===t.san))return this.plys=this.plys.slice(0,this.currentIndex+1),this.plys.push({pgnAsList:this.pgnAsList(t.san),fen:e,move:t}),this.currentIndex++,this.plys[this.currentIndex];this.moveForward()}},{key:"pgnAsList",value:function(e){var t,a=this.pgnListSoFar();if(t=a?Object(I.a)(a):[],this.plys.length%2!==0)t.push({moveNumber:t.length+1,whitePly:e,blackPly:""});else{var n=t[t.length-1];n.blackPly=e,t[t.length-1]=n}return t}},{key:"currentMove",value:function(){return Math.floor((this.currentIndex-1)/2)}},{key:"pgnListSoFar",value:function(){return this.plys[this.plys.length-1].pgnAsList}},{key:"fen",value:function(){return this.plys[this.currentIndex].fen}},{key:"moveForward",value:function(){return this.moveTo(this.currentIndex+1)}},{key:"moveBack",value:function(){return this.moveTo(this.currentIndex-1)}},{key:"moveTo",value:function(e){return e>=0&&e<this.plys.length&&(this.currentIndex=e),this.plys[this.currentIndex]}}]),e}(),z=a(636),U=a(637),_=a(638),V=a(283),Y=a(30),Q=a(24),q=a(147);function J(e,t,a,n){q.a.event({category:e,action:t,label:a,value:n})}q.a.initialize("UA-159149755-1");var K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).openingManager=new W,a.state={currentMove:0},window.addEventListener("keydown",a.keyHandler.bind(Object(u.a)(a))),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"keyHandler",value:function(e){switch(e.keyCode){case 37:this.previous(e,"keyboard");break;case 39:this.next(e,"keyboard")}}},{key:"shouldComponentUpdate",value:function(e){return e.fen===this.openingManager.fen()||(null===e.move?(this.openingManager=new W,!0):(this.openingManager.addPly(e.fen,e.move),!0))}},{key:"previous",value:function(e,t){var a=this.openingManager.moveBack();this.props.onChange(a.fen,a.move),this.setState({currentMove:this.openingManager.currentMove()}),J("navigator","Previous",t||"mouse")}},{key:"next",value:function(e,t){var a=this.openingManager.moveForward();this.props.onChange(a.fen,a.move),this.setState({currentMove:this.openingManager.currentMove()}),J("navigator","Next",t||"mouse")}},{key:"moveTo",value:function(e){var t=this;return function(){var a=t.openingManager.moveTo(2*e+1);t.props.onChange(a.fen,a.move),t.setState({currentMove:t.openingManager.currentMove()}),J("navigator","move",null,e)}}},{key:"render",value:function(){var e=this,t=B()(this.openingManager.fen());return t&&(this.opening=t.name,this.openingCode=t.code),this.openingManager.pgnListSoFar()?p.a.createElement(z.a,null,p.a.createElement(U.a,null,p.a.createElement(_.a,{lg:"6",className:"navSection"},p.a.createElement(V.a,{color:"",className:"settingButton",onClick:this.previous.bind(this)},p.a.createElement(Y.a,{icon:Q.k})," prev")," "),p.a.createElement(_.a,{lg:"6",className:"navSection"},p.a.createElement(V.a,{color:"",className:"settingButton",onClick:this.next.bind(this)},"next ",p.a.createElement(Y.a,{icon:Q.l})))),p.a.createElement(U.a,{className:"greyText"},this.openingCode,": ",this.opening),this.openingManager.pgnListSoFar().map((function(t,a){return p.a.createElement(U.a,{key:"".concat(t.moveNumber),onClick:e.moveTo(a).bind(e),className:"navCol ".concat(e.openingManager.currentMove()===a?"selectedMove":"")},p.a.createElement(_.a,{sm:"12",className:"navMove border"},"".concat(t.moveNumber,". ").concat(t.whitePly," ").concat(t.blackPly)))}))):p.a.createElement("div",null)}}]),t}(p.a.Component),H=a(46),$=(a(336),a(639)),Z=a(640),X=a(641),ee=a(642),te=a(643),ae=a(681),ne=a(682),se=a(644),re=a(645),oe=a(683),ie=a(646),le=a(647),ce=a(648),ue=a(649),he=function(e){var t=Object(m.useState)(!1),a=Object(H.a)(t,2),n=a[0],s=a[1],r=Object(m.useState)(!1),o=Object(H.a)(r,2),i=o[0],l=o[1],c=function(){return l(!i)},u=function(e){return function(){window.open(e,"_blank")}};return p.a.createElement("div",null,p.a.createElement($.a,{color:"light",light:!0,expand:"md"},p.a.createElement("img",{src:"/opening-tree-logo.png",height:"32px",width:"32px",alt:"Logo"}),p.a.createElement(Z.a,{href:"/"},"\xa0OpeningTree.com"),p.a.createElement(X.a,{onClick:function(){return s(!n)}}),p.a.createElement(ee.a,{isOpen:n,navbar:!0},p.a.createElement(te.a,{className:"mr-auto",navbar:!0}),p.a.createElement(ae.a,{navbar:!0},p.a.createElement(ne.a,{className:"bootNavColor",nav:!0,caret:!0},"More"),p.a.createElement(se.a,{right:!0},p.a.createElement(re.a,{onClick:c},"Acknowledgements"),p.a.createElement(re.a,{onClick:u("mailto:openingtreechess@gmail.com")},"Feedback"),p.a.createElement(re.a,{onClick:u("https://www.reddit.com/message/compose/?to=opening_tree")},"Message me on reddit"),p.a.createElement(re.a,{divider:!0}),p.a.createElement(re.a,{onClick:u("https://lichess.org/")},"Lichess"),p.a.createElement(re.a,{onClick:u("https://www.lichess4545.com/")},"Lichess4545"),p.a.createElement(re.a,{onClick:u("https://www.chess.com")},"Chess.com"))))),p.a.createElement(oe.a,{isOpen:i,toggle:c},p.a.createElement(ie.a,{toggle:c},"Acknowledgements"),p.a.createElement(le.a,{className:"acknowledgement"},p.a.createElement(ce.a,{tag:"a",href:"https://lichess.org/api",target:"_blank",action:!0},"Lichess API"),p.a.createElement(ce.a,{tag:"a",href:"https://www.chess.com/club/chess-com-developer-community",target:"_blank",action:!0},"Chess.com API"),p.a.createElement(ce.a,{tag:"a",href:"https://github.com/ruilisi/react-chessground",target:"_blank",action:!0},"ChessGround"),p.a.createElement(ce.a,{tag:"a",href:"https://github.com/jhlywa/chess.js",target:"_blank",action:!0},"Chess.js"),p.a.createElement(ce.a,{tag:"a",href:"https://github.com/niklasf/eco",target:"_blank",action:!0},"Eco"),p.a.createElement(ce.a,{tag:"a",href:"https://github.com/jimmywarting/StreamSaver.js",target:"_blank",action:!0},"StreamSaver.js"),p.a.createElement(ce.a,{tag:"a",href:"https://www.flaticon.com/authors/google/",target:"_blank",action:!0},"Icons made by google"),p.a.createElement(ce.a,{tag:"a",href:"https://www.flaticon.com/",target:"_blank",action:!0},"FlatIcons.com"),p.a.createElement(ce.a,{tag:"a",href:"https://www.freelogodesign.org",target:"_blank",action:!0},"Free logo design"),p.a.createElement(ce.a,{tag:"a",href:"https://github.com/kevinludwig/pgn-parser",target:"_blank",action:!0},"PGN Parser"),p.a.createElement(ce.a,{tag:"a",href:"https://www.reddit.com/r/chess",target:"_blank",action:!0},"r/chess"),p.a.createElement(ce.a,{tag:"a",href:"https://www.reddit.com/r/anarchychess",target:"_blank",action:!0},"r/anarchychess")),p.a.createElement(ue.a,null,p.a.createElement(V.a,{color:"secondary",onClick:c},"Done"))))},me=a(286),pe=a(6),de=a(684),ge=Object(pe.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(de.a);function fe(e){return p.a.createElement("img",{className:"lowOpacity styledNumbers",src:"/images/styled-".concat(e,".png"),height:24})}var ve=a(656),be=a(657),ye=a(677),Ee=a(655),we=a(654),Ce=a(98),ke=a.n(Ce),Ne=a(653),Oe=a(288),Se=a.n(Oe),Fe=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getSourceOption",value:function(e,t){return"lichess"===e?p.a.createElement("span",null,t?fe("done"):null,p.a.createElement("img",{alt:"lichess",className:"siteimage",src:"./lichesslogo.png"}),p.a.createElement("span",{className:"sourceName"}," lichess.org ")):"chesscom"===e?p.a.createElement("span",null,t?fe("done"):null,p.a.createElement("img",{alt:"chess.com",className:"siteimage",src:"./chesscomlogo.png"})):"pgnfile"===e?p.a.createElement("span",null,t?fe("done"):null,p.a.createElement(Se.a,{className:"lowOpacity"}),p.a.createElement("span",{className:"sourceName"}," PGN file")):p.a.createElement("span",null,fe(1),"Select a source")}},{key:"render",value:function(){return p.a.createElement(ge,{TransitionComponent:Ne.a,TransitionProps:{timeout:500},expanded:"source"===this.props.expandedPanel,onChange:this.props.handleExpansionChange},p.a.createElement(we.a,{expandIcon:p.a.createElement(ke.a,null),"aria-controls":"panel1c-content",id:"panel1c-header"},p.a.createElement("div",null,this.getSourceOption(this.props.site,!0))),p.a.createElement(Ee.a,null,p.a.createElement(ve.a,{onChange:this.props.siteChange},p.a.createElement(be.a,{className:"sitelabel",value:"lichess",control:p.a.createElement(ye.a,{color:"primary"}),label:this.getSourceOption("lichess")}),p.a.createElement(be.a,{className:"sitelabel",value:"chesscom",control:p.a.createElement(ye.a,{color:"primary"}),label:this.getSourceOption("chesscom")}),p.a.createElement(be.a,{className:"sitelabel",value:"pgnfile",control:p.a.createElement(ye.a,{color:"primary"}),label:this.getSourceOption("pgnfile")}))))}}]),t}(p.a.Component),Te=a(675),Pe=a(661),xe=a(662),je=a(663),Re=a(304),Ae=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.a.createElement(Re.a,{acceptedFiles:[],dropzoneText:"Drag and drop up to 10 pgn files here or click to select",onChange:this.props.filesChange,dropzoneParagraphClass:"dropzonetext",showFileNames:!0,useChipsForPreview:!0,previewChipProps:{className:"previewChip"},dropzoneClass:"dropzone",filesLimit:10,maxFileSize:3e12})}}]),t}(p.a.Component),Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={playerName:"",files:[]},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"editPlayerName",value:function(e){this.setState({playerName:e.target.value,playerNameError:""})}},{key:"filesChange",value:function(e){this.setState({files:e})}},{key:"validateInputDetailsSet",value:function(){if("lichess"===this.props.site||"chesscom"===this.props.site){if(!this.state.playerName)return this.setState({playerNameError:"Please enter a username"}),!1}else if("pgnfile"===this.props.site&&0===this.state.files.length)return this.props.showError("Please upload a PGN file"),!1;return!0}},{key:"setPlayerDetails",value:function(){this.validateInputDetailsSet()&&this.props.playerDetailsChange(this.state.playerName,this.state.files)}},{key:"getSummary",value:function(){return this.props.playerName?p.a.createElement("span",null,fe("done"),"User: ",p.a.createElement("b",null,this.props.playerName)):1===this.props.files.length?p.a.createElement("span",null,fe("done"),"File: ",p.a.createElement("b",null,this.props.files[0].name)):this.props.files.length>1?p.a.createElement("span",null,fe("done"),this.props.files.length," PGN files uploaded"):p.a.createElement("span",null,fe(2),"Player details")}},{key:"getPlayerNameInput",value:function(e){return p.a.createElement(Te.a,{className:"playernameField",name:"playerName",id:"playerNameTextBox",margin:"dense",onChange:this.editPlayerName.bind(this),label:e,variant:"outlined",helperText:this.state.playerNameError,error:!!this.state.playerNameError})}},{key:"getInputsToShow",value:function(){return"pgnfile"===this.props.site?p.a.createElement(Ae,{filesChange:this.filesChange.bind(this)}):"lichess"===this.props.site?this.getPlayerNameInput("lichess username"):"chesscom"===this.props.site?this.getPlayerNameInput("chess.com username"):void 0}},{key:"render",value:function(){return p.a.createElement(ge,{expanded:"user"===this.props.expandedPanel,TransitionComponent:Ne.a,TransitionProps:{timeout:500},onChange:this.props.handleExpansionChange,disabled:""===this.props.site},p.a.createElement(we.a,{expandIcon:p.a.createElement(ke.a,null)},this.getSummary()),p.a.createElement(Ee.a,null,this.getInputsToShow()),p.a.createElement(xe.a,null),p.a.createElement(je.a,null,p.a.createElement(Pe.a,{size:"small"},"Random"),p.a.createElement(Pe.a,{size:"small",color:"primary",onClick:this.setPlayerDetails.bind(this)},"Save")))}}]),t}(p.a.Component),Ge=a(686),De=a(598),Le=a(679),Be=a(687),Ie=[{label:"Fast time controls",selectedTimeControls:["bullet","ultraBullet","blitz"],unselectedTimeControls:["rapid","classical","correspondence"]},{label:"Slow time controls",selectedTimeControls:["rapid","classical","correspondence"],unselectedTimeControls:["bullet","ultraBullet","blitz"]},{label:"Reasonable time controls",selectedTimeControls:["blitz","rapid","classical","correspondence"],unselectedTimeControls:["bullet","ultraBullet"]},{label:"Exclude slow time controls",selectedTimeControls:["bullet","ultraBullet","blitz","rapid"],unselectedTimeControls:["classical","correspondence"]}];function We(e,t){return t.every((function(t){return e.includes(t)}))}var ze=function(e,t){var a=S(e,t,!0),n=S(e,t,!1);return 0===n.length||0===a.length?"All time controls":1===a.length?C[a[0]]:1===n.length?"All except ".concat(C[n[0]]):2===a.length?"".concat(C[a[0]]," and ").concat(C[a[1]]):function(e,t){var a=Ie.filter((function(a){return We(t,a.unselectedTimeControls)&&We(e,a.selectedTimeControls)}));if(a.length)return a[0].label;return e.map((function(e){return C[e]})).join(", ")}(a,n)};var Ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentlyOpenAdvancedFilter:""},a.timeframeMarks=[{value:0,label:"Big bang"},{value:e.timeframeSteps.length-1,label:"Now"}],a.downloadLimitMarks=[{value:0,label:"0"},{value:2e3,label:"No limit"}],a.eloRangeMarks=[{value:0,label:"0"},{value:3e3,label:"No limit"}],a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"setCurrentlyOpenAdvancedFilter",value:function(e){var t=this;return function(){t.state.currentlyOpenAdvancedFilter===e&&(e=""),t.setState({currentlyOpenAdvancedFilter:e}),J("loader","AdvancedFilterChange",e)}}},{key:"getFilters",value:function(e){return p.a.createElement("div",null,this.subSectionComponent("Mode","all"===(r=this.props.advancedFilters.rated)?"Rated and casual":"rated"===r?"Rated only":"casual"===r?"Casual only":void 0,this.props.toggleRated),this.subSectionComponent("Time control",ze(this.props.site,this.props.advancedFilters),this.setCurrentlyOpenAdvancedFilter("timeControl").bind(this),p.a.createElement(ee.a,{isOpen:"timeControl"===this.state.currentlyOpenAdvancedFilter},this.getTimeControlFilters(e,4))),this.subSectionComponent("When played",(n=this.props.advancedFilters.selectedTimeframe,s=this.props.timeframeSteps,P(n,s).label),this.setCurrentlyOpenAdvancedFilter("whenPlayed").bind(this),p.a.createElement(ee.a,{isOpen:"whenPlayed"===this.state.currentlyOpenAdvancedFilter},this.getTimeFrameFilters())),this.subSectionComponent("Opponent elo range",0===(a=this.props.advancedFilters.eloRange)[0]&&3e3===a[1]?"All elo ratings":0===a[0]?"Below ".concat(a[1]):3e3===a[1]?"Above ".concat(a[0]):"Between ".concat(a[0]," and ").concat(a[1]),this.setCurrentlyOpenAdvancedFilter("eloRange").bind(this),p.a.createElement(ee.a,{isOpen:"eloRange"===this.state.currentlyOpenAdvancedFilter},this.getEloRangeFilters())),this.subSectionComponent("Download limit",(t=this.props.advancedFilters.downloadLimit)>=2e3?"No limit":"".concat(t," games"),this.setCurrentlyOpenAdvancedFilter("downloadLimit").bind(this),p.a.createElement(ee.a,{isOpen:"downloadLimit"===this.state.currentlyOpenAdvancedFilter},this.getDownloadLimitFilters())));var t,a,n,s,r}},{key:"getDownloadLimitFilters",value:function(){return p.a.createElement(Be.a,{className:"sliderCustom",value:this.props.advancedFilters.downloadLimit,onChange:this.props.handleDownloadLimitChange,valueLabelDisplay:"auto",valueLabelFormat:function(e){return e>=2e3?"All":e},step:100,min:0,marks:this.downloadLimitMarks,max:2e3})}},{key:"getTimeFrameFilters",value:function(){var e=this;return p.a.createElement(Be.a,{className:"sliderCustom",value:this.props.advancedFilters.selectedTimeframe,onChange:this.props.handleTimeframeChange,valueLabelDisplay:"off",valueLabelFormat:function(t){return e.props.timeframeSteps[t].label},step:1,marks:this.timeframeMarks,min:0,max:this.props.timeframeSteps.length-1})}},{key:"getEloRangeFilters",value:function(){return p.a.createElement(Be.a,{className:"sliderCustom",value:this.props.advancedFilters.eloRange,onChange:this.props.handleEloRangeChange,valueLabelDisplay:"off",marks:this.eloRangeMarks,min:0,max:3e3})}},{key:"getTimeControlFilters",value:function(e){var t=null,a=null,n=null,s=null;return"lichess"===e?(t=["bullet","ultraBullet"],a=["blitz","classical"],n=["rapid","correspondence"],s="4"):(t=["bullet","blitz"],n=["rapid","daily"],s="6"),p.a.createElement(Ge.a,null,p.a.createElement(De.a,null,p.a.createElement(z.a,null,this.getTimeControlFilterRow(t,s,"first"),a?this.getTimeControlFilterRow(a,s,"middle"):null,this.getTimeControlFilterRow(n,s,"last"))))}},{key:"getTimeControlFilterRow",value:function(e,t,a){var n=this,s="topBottomNegativeMargin";return"first"===a?s="bottomNegativeMargin":"last"===a&&(s="topNegativeMargin"),p.a.createElement(U.a,{className:s},e.map((function(e){return p.a.createElement(_.a,{sm:t,key:"ctrl".concat(e)},p.a.createElement(be.a,{className:"nomargin",control:p.a.createElement(Le.a,{checked:n.props.advancedFilters[e],color:"primary",onChange:n.props.handleTimeControlChange,name:e}),label:C[e]}))})))}},{key:"subSectionComponent",value:function(e,t,a,n){return p.a.createElement("div",{className:"pgnloadersection"},e,": ",p.a.createElement("span",{className:"smallText"},"[",p.a.createElement("span",{className:"linkStyle",onClick:a},"change"),"]"),p.a.createElement("div",null,p.a.createElement("b",null,t)),n)}},{key:"render",value:function(){return this.getFilters(this.props.site)}}]),t}(p.a.Component),_e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={playerColor:a.props.playerColor,isAdvancedFiltersOpen:!1,filtersSet:!1},a.timeframeSteps=a.props.timeframeSteps,Object.assign(a.state,a.props.advancedFilters),a.defaultAdvancedFilters=a.props.advancedFilters,a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"toggleRated",value:function(){"all"===this.state.rated?this.setState({rated:"rated"}):"rated"===this.state.rated?this.setState({rated:"casual"}):this.setState({rated:"all"}),J("loader","AdvancedFilterChange","rated")}},{key:"toggleState",value:function(e){var t=this;return function(){var a={};a[e]=!t.state[e],t.setState(a),J("loader","ToggleAdvancedFilters",t.state.site)}}},{key:"playerColorChange",value:function(e){var t=this;return function(){t.setState({playerColor:e}),J("loader","ColorChange",e)}}},{key:"handleTimeControlChange",value:function(e){this.setState(Object(y.a)({},e.target.name,e.target.checked))}},{key:"handleTimeframeChange",value:function(e,t){this.setState(Object(y.a)({},"selectedTimeframe",t))}},{key:"handleEloRangeChange",value:function(e,t){this.setState(Object(y.a)({},"eloRange",t))}},{key:"handleDownloadLimitChange",value:function(e,t){this.setState(Object(y.a)({},"downloadLimit",t))}},{key:"setFilters",value:function(){this.setState({filtersSet:!0}),this.props.filtersChange(this.state)}},{key:"getSummary",value:function(){return this.state.filtersSet?p.a.createElement("span",null,fe("done"),"Color: ",p.a.createElement("b",null,"white"===this.props.playerColor?"White":"Black"," "),this.areAdvancedFiltersApplied()?p.a.createElement("span",{className:"smallText"},"(Filters applied)"):null):p.a.createElement("span",null,fe(3)," Color and filters")}},{key:"areAdvancedFiltersApplied",value:function(){for(var e=0,t=Object.entries(this.defaultAdvancedFilters);e<t.length;e++){var a=Object(H.a)(t[e],2),n=a[0],s=a[1];if(this.props.advancedFilters[n]!==s)return!0}return!1}},{key:"render",value:function(){return p.a.createElement(ge,{expanded:"filters"===this.props.expandedPanel,TransitionComponent:Ne.a,TransitionProps:{timeout:500},onChange:this.props.handleExpansionChange,disabled:!this.state.filtersSet&&"filters"!==this.props.expandedPanel},p.a.createElement(we.a,{expandIcon:p.a.createElement(ke.a,null)},this.getSummary()),p.a.createElement(Ee.a,null,p.a.createElement("div",{className:"pgnloadersection"},p.a.createElement("div",null,p.a.createElement(V.a,{onClick:this.playerColorChange("white"),color:"white"===this.state.playerColor?"secondary":"link"},"White"),p.a.createElement(V.a,{onClick:this.playerColorChange("black"),color:"black"===this.state.playerColor?"secondary":"link"},"Black"))),p.a.createElement("div",{className:"pgnloadersection"},p.a.createElement("span",{className:"linkStyle",onClick:this.toggleState("isAdvancedFiltersOpen").bind(this)},"Advanced filters ",p.a.createElement(Y.a,{icon:this.state.isAdvancedFiltersOpen?Q.b:Q.a})),p.a.createElement(ee.a,{isOpen:this.state.isAdvancedFiltersOpen},p.a.createElement(Ue,{site:this.props.site,toggleRated:this.toggleRated.bind(this),handleTimeControlChange:this.handleTimeControlChange.bind(this),handleTimeframeChange:this.handleTimeframeChange.bind(this),handleEloRangeChange:this.handleEloRangeChange.bind(this),timeframeSteps:this.timeframeSteps,handleDownloadLimitChange:this.handleDownloadLimitChange.bind(this),advancedFilters:(e=this.state,N(e,["ultraBullet","bullet","blitz","rapid","correspondence","daily","classical","rated","selectedTimeframe","downloadLimit","eloRange"]))})))),p.a.createElement(xe.a,null),p.a.createElement(je.a,null,p.a.createElement(Pe.a,{size:"small",color:"primary",onClick:this.setFilters.bind(this)},"Save")));var e}}]),t}(p.a.Component),Ve=a(116),Ye=a.n(Ve),Qe=a(99),qe=function e(t,a,n,s,r){Object(o.a)(this,e);var i="",l=encodeURIComponent(t),c="?color=".concat(a),u="".concat("all"===n.rated?"":"&rated=".concat("rated"===n.rated?"true":"false")),h=P(n.selectedTimeframe,T()),m="".concat(h.fromTimeStamp?"&since=".concat(h.fromTimeStamp):""),p="".concat(h.toTimeStamp?"&until=".concat(h.toTimeStamp):""),d=S("lichess",n,!0),g=0===d.length||6===d.length?"":"&perfType=".concat(d.join(",")),f=Ye.a.get("https://lichess.org/api/games/user/"+l+c+u+g+m+p,{json:!1}).on("error",(function(e){r("failed to connect to lichess.org"),s([],!1)})).on("response",(function(e){404===e.statusCode?r("could not find lichess user "+t):200!==e.statusCode&&r("could not load games of lichess user "+t)})).on("data",(function(e){var r=i+e.toString(),o=r.lastIndexOf("\n\n\n"),l=r.slice(0,o).trim();i=r.slice(o).trim();var c=l.split("\n\n\n").map((function(e){try{return Object(Qe.parse)(e)[0]}catch(a){return console.log("failed to parse pgn",e),console.log(a),J("error","parseFailedLichess",t),null}}));s(c.filter((function(e){return!(!e||"Standard"!==e.headers.Variant)&&!!j("white"===a?e.headers.BlackElo:e.headers.WhiteElo,n.eloRange)})),!0)||f.abort()})).on("end",(function(){s([],!1)}))},Je=a(301),Ke=a.n(Je),He=function e(t,a,n,s,r){Object(o.a)(this,e);var i=new Ke.a({queue:!0}),l=0,c=function(e){if(l--,!s(e.body.games.filter((function(e){if("chess"!==e.rules||e[a].username.toLowerCase()!==t.toLowerCase())return!1;var s=n.rated;return!("rated"===s&&!e.rated)&&(("casual"!==s||!e.rated)&&(!!n[e.time_class]&&!!j("white"===a?e.black.rating:e.white.rating,n.eloRange)))})).map((function(e){try{return Object(Qe.parse)(e.pgn)[0]}catch(n){return console.log("failed to parse pgn",e),console.log(n),J("error","parseFailedChessCom","".concat(t,":").concat(a)),null}})).filter((function(e){return null!==e})),l>0)){for(;i.dequeue(););l=0,s([],!1)}},u=P(n.selectedTimeframe,T()),h=function(e){e.archives.reverse().forEach((function(e){var a=e.split("/"),n=a[a.length-2],s=a[a.length-1];(function(e,t,a){var n=a.fromYear||1970,s=a.toYear||1e4,r=a.fromYear||0,o=a.toYear||11;return t>n&&t<s||!(t<n||t>s)&&(t===n?e>=r:t===s?e<=o:(console.log("should not happen"),!0))})(s,n,u)&&(l++,i.dispatch(i.getPlayerCompleteMonthlyArchives,c,[t,n,s]))})),0===l&&(r("Could not find games for chess.com user "+t),s([],!1))};Ye()("https://api.chess.com/pub/player/".concat(t,"/games/archives"),(function(e,a,n){if(e)r("Could not connect to chess.com"),s([],!1);else if(404===a.statusCode)r("Could not find chess.com user "+t),s([],!1);else if(200!==a.statusCode)r("Could not load games for chess.com user "+t),s([],!1);else if(a.body)try{var o=JSON.parse(a.body);h(o)}catch(i){r("Could not find games for chess.com user "+t),s([],!1)}}))},$e=function e(t,a,n,s,r,i){Object(o.a)(this,e);var l=new FileReader;l.onload=function(e){var a=e.target.result.split("\n\n\n").map((function(e){try{return Object(Qe.parse)(e)[0]}catch(a){return console.log("failed to parse pgn",e),console.log(a),J("error","parseFailedPGNFile",t),null}}));r(a.filter((function(e){return!!e})),!0)},l.onerror=function(){i("Failed to load pgn file"),r([],!1)},l.onloadend=function(){r([],!1)},l.readAsText(a[0])},Ze=a(192),Xe=a.n(Ze),et=function(){function e(){Object(o.a)(this,e),this.totalGames=0,this.pendingGames=0,this.pendingDownloads=!0,Xe.a.mitm="download/download-mitm.html",this.fileWriter=null}return Object(i.a)(e,[{key:"stopDownloading",value:function(){this.fileWriter&&(this.fileWriter.close(),this.fileWriter=null)}},{key:"getPgnString",value:function(e){return"".concat(Object.entries(e.headers).map((function(e){return"[".concat(e[0],' "').concat(e[1],'"]')})).join("\n"),"\n                \n").concat(e.moves.map((function(e,t){return"".concat(t%2!==0?"":t/2+1+"."," ").concat(e.move)})).join(" ")," ").concat(e.result,"\n\n\n")}},{key:"fetchPGNFromSite",value:function(e,t,a,n,s,r,o,i,l){var c=this;if(this.continueProcessingGames=!0,n){var u=Xe.a.createWriteStream("".concat(e,"-").concat(t,".pgn"));this.fileWriter=u.getWriter()}var h=new TextEncoder,m=n?function(e,t){return c.fileWriter.write(h.encode(e.map((function(e){return c.getPgnString(e)})).join(""))).then((function(){t||c.stopDownloading()})),!0}:function(a,n){return a?(c.totalGames+=a.length,c.pendingGames+=a.length,c.pendingDownloads=n,setTimeout((function(){c.parsePGNTimed(a,s,t,0,e,r,o,i)}),1),c.continueProcessingGames):c.continueProcessingGames};"lichess"===a?new qe(e,t,s,m,o):"chesscom"===a?new He(e,t,s,m,o):"pgnfile"===a&&new $e(e,l,t,s,m,o)}},{key:"parsePGNTimed",value:function(e,t,a,n,s,r,o,i){var l=this;if(n<e.length&&this.pendingGames--,!this.pendingDownloads&&this.pendingGames<=0&&i(),!(n>=e.length)&&this.continueProcessingGames){var c=e[n];if(c.moves[0]&&1===c.moves[0].move_number){var u=new g.a,h=this.gameResult(c);c.moves.forEach((function(e){var t=u.fen(),n=u.move(e.move),r=u.fen();if(!n)return console.log("failed to load game "+c),void o("Failed to load game","".concat(s,":").concat(a));D.addMoveForFen(t,r,n,h,a)}));var m=u.fen();D.addGameResultOnFen(m,h),D.addResultToRoot(h,a),this.continueProcessingGames=r(t.downloadLimit,1,D)}setTimeout((function(){l.parsePGNTimed(e,t,a,n+1,s,r,o,i)}),1)}}},{key:"gameResult",value:function(e){return{result:e.result,white:e.headers.White,black:e.headers.Black,whiteElo:e.headers.WhiteElo,blackElo:e.headers.BlackElo,url:e.headers.Link||e.headers.Site,date:e.headers.Date}}}]),e}(),tt=a(303),at=a.n(tt),nt=a(302),st=a.n(nt),rt=a(660),ot=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).unload=function(){a.pgnReader&&a.pgnReader.stopDownloading()},a.state={isGamesSubsectionOpen:!1},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.unload)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.unload)}},{key:"readPgn",value:function(e){this.pgnReader=new et,this.pgnReader.fetchPGNFromSite(this.props.playerName,this.props.playerColor,this.props.site,e,this.props.advancedFilters,this.props.notify,this.props.showError,this.stopDownloading.bind(this),this.props.files)}},{key:"download",value:function(){this.props.playerName?(this.readPgn(!0),J("loader","Download",this.props.site,"white"===this.props.playerColor?1:0)):this.props.showError("Please enter a username")}},{key:"load",value:function(){this.props.clear(),this.setState({isGamesSubsectionOpen:!0}),this.props.onChange("playerName",this.props.playerName),this.props.onChange("playerColor",this.props.playerColor),this.readPgn(!1),this.props.setDownloading(!0),J("loader","Load",this.props.site,"white"===this.props.playerColor?1:0)}},{key:"stopDownloading",value:function(){this.props.setDownloading(!1)}},{key:"stopDownloadingAction",value:function(){this.stopDownloading(),J("loader","StopDownloading",this.props.site)}},{key:"mainComponent",value:function(){var e=this;return p.a.createElement("div",{style:{}},p.a.createElement("div",{className:"pgnloadersection"},p.a.createElement(Pe.a,{onClick:this.load.bind(this),variant:"contained",color:"primary",startIcon:p.a.createElement(st.a,null),className:"mainButton",disableElevation:!0},"Analyze games")),p.a.createElement("div",{className:"pgnloadersection"},p.a.createElement(Pe.a,{onClick:this.download.bind(this),variant:"contained",color:"default",startIcon:p.a.createElement(at.a,null),className:"mainButton",disableElevation:!0},"Export as PGN")),this.state.isGamesSubsectionOpen?p.a.createElement("div",null,p.a.createElement("div",{className:"pgnloadersection"},"Games Loaded: ".concat(this.props.gamesProcessed," "),this.props.isDownloading?p.a.createElement("span",{className:"stopDownloading"},"[",p.a.createElement("span",{className:"linkStyle",onClick:this.stopDownloadingAction.bind(this)},p.a.createElement("img",{alt:"loading spinner",src:"./spinner.gif",height:"15"}),"stop"),"]"):""),p.a.createElement("div",{onClick:function(){return e.props.switchToMovesTab()},className:"navLinkButton pgnloadersection"},p.a.createElement(Y.a,{icon:Q.i})," View Moves>>")):"")}},{key:"render",value:function(){return this.props.expandedPanel?p.a.createElement(rt.a,{timeout:1e3},this.mainComponent()):p.a.createElement(rt.a,{in:!0,timeout:1500},this.mainComponent())}}]),t}(p.a.Component),it=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={playerName:"",site:"",playerColor:a.props.settings.playerColor,isAdvancedFiltersOpen:!1,isGamesSubsectionOpen:!1,expandedPanel:"source",files:[]},a.timeframeSteps=T(),a.state.selectedTimeframe=[0,a.timeframeSteps.length-1],a.state.downloadLimit=2e3,a.state.ultraBullet=!0,a.state.bullet=!0,a.state.blitz=!0,a.state.rapid=!0,a.state.classical=!0,a.state.correspondence=!0,a.state.daily=!0,a.state.rated="all",a.state.eloRange=[0,3e3],a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"advancedFilters",value:function(){return N(this.state,["ultraBullet","bullet","blitz","rapid","correspondence","daily","classical","rated","selectedTimeframe","downloadLimit","eloRange"])}},{key:"handleExpansionChange",value:function(e){var t=this;return function(a,n){t.setState({expandedPanel:!!n&&e})}}},{key:"playerDetailsChange",value:function(e,t){this.setState({playerName:e,expandedPanel:"filters",files:t}),J("loader","PlayerNameSaved")}},{key:"siteChange",value:function(e){this.setState({site:e.target.value,expandedPanel:"user"}),J("loader","ChangeSite",this.state.site)}},{key:"filtersChange",value:function(e){this.setState(Object(me.a)({},e,{expandedPanel:""})),J("loader","FitlersSaved",this.state.site)}},{key:"render",value:function(){return p.a.createElement("div",null,p.a.createElement("div",{className:"pgnloadersection"},p.a.createElement(Fe,{expandedPanel:this.state.expandedPanel,handleExpansionChange:this.handleExpansionChange("source").bind(this),site:this.state.site,siteChange:this.siteChange.bind(this)}),p.a.createElement(Me,{expandedPanel:this.state.expandedPanel,playerName:this.state.playerName,handleExpansionChange:this.handleExpansionChange("user").bind(this),showError:this.props.showError,files:this.state.files,site:this.state.site,playerDetailsChange:this.playerDetailsChange.bind(this)}),p.a.createElement(_e,{expandedPanel:this.state.expandedPanel,playerColor:this.state.playerColor,handleExpansionChange:this.handleExpansionChange("filters").bind(this),site:this.state.site,advancedFilters:this.advancedFilters(),timeframeSteps:this.timeframeSteps,filtersChange:this.filtersChange.bind(this)})),p.a.createElement(ot,{expandedPanel:this.state.expandedPanel,playerColor:this.state.playerColor,files:this.state.files,playerName:this.state.playerName,site:this.state.site,advancedFilters:this.advancedFilters(),notify:this.props.notify,showError:this.props.showError,onChange:this.props.onChange,setDownloading:this.props.setDownloading,clear:this.props.clear,isDownloading:this.props.isDownloading,switchToMovesTab:this.props.switchToMovesTab,gamesProcessed:this.props.gamesProcessed}))}}]),t}(p.a.Component),lt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"toggle",value:function(e){var t=this;return function(){var a="white"===t.props.settings[e]?"black":"white";t.props.onChange(e,a),J("controls","ChangeOrientation")}}},{key:"analyse",value:function(){window.open("https://www.lichess.org/analysis/".concat(this.props.fen),"_blank"),J("controls","AnalyzeGame")}},{key:"resetAction",value:function(){this.props.reset(),J("controls","Reset")}},{key:"clearAction",value:function(){this.props.clear(),J("controls","Clear")}},{key:"render",value:function(){return p.a.createElement("div",null,p.a.createElement(z.a,null,p.a.createElement(U.a,{sm:"12"},p.a.createElement(_.a,{sm:"6"},p.a.createElement(V.a,{className:"settingButton",onClick:this.toggle("orientation"),color:""},p.a.createElement("h3",null,p.a.createElement(Y.a,{icon:Q.j}))," Flip board")),p.a.createElement(_.a,{sm:"6"},p.a.createElement(V.a,{className:"settingButton",onClick:this.clearAction.bind(this),color:""},p.a.createElement("h3",null,p.a.createElement(Y.a,{icon:Q.m}))," Clear games")),p.a.createElement(_.a,{sm:"6"},p.a.createElement(V.a,{className:"settingButton",onClick:this.resetAction.bind(this),color:""},p.a.createElement("h3",null,p.a.createElement(Y.a,{icon:Q.g}))," Starting position")),p.a.createElement(_.a,{sm:"6"},p.a.createElement(V.a,{className:"settingButton",onClick:this.analyse.bind(this),color:""},p.a.createElement("h3",null,p.a.createElement(Y.a,{icon:Q.e}))," Computer analysis")))))}}]),t}(p.a.Component),ct=a(671),ut=a(672),ht=a(673),mt=a(674),pt=a(7),dt=a.n(pt),gt=a(680),ft=a(670),vt=a(664),bt=a(668),yt=a(666),Et=a(667),wt=a(665),Ct=a(669),kt=function(e){function t(e){return Object(o.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"eatClicks",value:function(e){e.stopPropagation()}},{key:"copyFen",value:function(){var e=document.getElementById("fenField");e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),this.props.showInfo("FEN copied")}},{key:"getFenField",value:function(){return this.props.simplifiedView?null:p.a.createElement("div",{className:"fenDiv"},p.a.createElement(Te.a,{id:"fenField",multiline:!0,label:"FEN",rowsMax:"2",value:this.props.fen,inputProps:{style:{fontSize:12},spellCheck:!1},variant:"outlined",className:"fenField",margin:"dense",onClick:this.copyFen.bind(this)}))}},{key:"render",value:function(){var e=this;if(!this.props.moveDetails.lastPlayedGame)return p.a.createElement("div",null,this.getFenField(),p.a.createElement("div",{className:"infoMessage"},"No data to show. Please enter a lichess or chess.com user name in the",p.a.createElement("span",{className:"navLinkButton",onClick:function(){return e.props.switchToUserTab()}}," ",p.a.createElement(Y.a,{icon:Q.n})," User"),' tab and click "Load"'));var t={};return this.props.isOpen&&(t=function(e,t,a,n,s){var r=t+a+n,o=Math.round(e/r),i=("white"===s?t:n)+a/2,l=Math.round(100*i/r),c=k[l];return{performanceRating:o+c,averageElo:o,score:"".concat(Number.isInteger(i)?i:i.toFixed(1),"/").concat(r),ratingChange:"".concat(0===c?"":c>0?"+":"-").concat(Math.abs(c))}}(this.props.moveDetails.totalOpponentElo,this.props.moveDetails.whiteWins,this.props.moveDetails.draws,this.props.moveDetails.blackWins,this.props.settings.playerColor)),p.a.createElement("div",null,this.getFenField(),p.a.createElement(vt.a,{onClick:this.eatClicks},p.a.createElement(wt.a,{className:"performanceRatingRow".concat(this.props.simplifiedView?" performanceHeader":"")},p.a.createElement(yt.a,null,p.a.createElement(Et.a,{className:"performanceRatingRow"},p.a.createElement("b",null,"Performance")),p.a.createElement(Et.a,{className:"performanceRatingRow"},p.a.createElement("b",null,t.performanceRating)))),p.a.createElement(bt.a,null,p.a.createElement(yt.a,{className:"performanceRatingRow"},p.a.createElement(Et.a,{className:"performanceRatingRow"},"Avg opponent"),p.a.createElement(Et.a,{className:"performanceRatingRow"},t.averageElo)),p.a.createElement(yt.a,{className:"performanceRatingRow"},p.a.createElement(Et.a,{className:"performanceRatingRow"},"Score"),p.a.createElement(Et.a,{className:"performanceRatingRow"},t.score)),this.props.simplifiedView?null:p.a.createElement(yt.a,{className:"performanceRatingRow"},p.a.createElement(Et.a,{className:"performanceRatingRow"},"Rating change"),p.a.createElement(Et.a,{className:"performanceRatingRow"},t.ratingChange)),!this.props.simplifiedView&&this.props.moveDetails.bestWin?p.a.createElement(yt.a,{className:"performanceRatingRow"},p.a.createElement(Et.a,{className:"performanceRatingRow"},"Best win"),p.a.createElement(Et.a,{className:"performanceRatingRow"},this.props.moveDetails.bestWin," ",p.a.createElement(Y.a,{className:"pointerExternalLink",onClick:this.props.launchGame(this.props.moveDetails.bestWinGame.url),icon:Q.f}))):null,!this.props.simplifiedView&&this.props.moveDetails.worstLoss?p.a.createElement(yt.a,{className:"performanceRatingRow"},p.a.createElement(Et.a,{className:"performanceRatingRow"},"Worst loss"),p.a.createElement(Et.a,{className:"performanceRatingRow"},this.props.moveDetails.worstLoss," ",p.a.createElement(Y.a,{className:"pointerExternalLink",onClick:this.props.launchGame(this.props.moveDetails.worstLossGame.url),icon:Q.f}))):null,p.a.createElement(yt.a,{className:"performanceRatingRow"},p.a.createElement(Et.a,{className:"performanceRatingRow"},"Last played"),p.a.createElement(Et.a,{className:"performanceRatingRow"},this.props.moveDetails.lastPlayedGame.date," ",p.a.createElement(Y.a,{className:"pointerExternalLink",onClick:this.props.launchGame(this.props.moveDetails.lastPlayedGame.url),icon:Q.f})))),this.props.simplifiedView?null:p.a.createElement(Ct.a,null,p.a.createElement(yt.a,null,p.a.createElement(Et.a,{colSpan:"2"},"Calculated based on ",p.a.createElement("a",{href:"https://handbook.fide.com/chapter/B022017",target:"_blank",rel:"noopener noreferrer"},"FIDE regulations"))))))}}]),t}(p.a.Component),Nt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={openPerformanceIndex:null},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"move",value:function(e,t){var a=this;return function(){a.props.onMove(e,t),J("moves","MoveClicked")}}},{key:"componentDidUpdate",value:function(e,t){e.turnColor!==this.props.turnColor&&this.setState({openPerformanceIndex:null})}},{key:"togglePerformancePopover",value:function(e){var t=this;return function(a){null!==t.state.openPerformanceIndex?t.setState({openPerformanceIndex:null}):t.setState({openPerformanceIndex:e}),a.stopPropagation()}}},{key:"render",value:function(){var e=this;return this.props.settings.playerName?p.a.createElement("div",null,this.props.gameResults&&this.props.gameResults.length>0?this.resultsTable():null,this.movesTable()):p.a.createElement("div",{className:"infoMessage"},"No moves to show. Please enter a lichess or chess.com user name in the",p.a.createElement("span",{className:"navLinkButton",onClick:function(){return e.props.switchToUserTab()}}," ",p.a.createElement(Y.a,{icon:Q.n})," User"),' tab and click "Load"')}},{key:"resultsTable",value:function(){var e=this;return p.a.createElement(vt.a,null,p.a.createElement(bt.a,null,this.props.gameResults.map((function(t){var a=e.player(t.white,t.whiteElo),n=e.player(t.black,t.blackElo);return p.a.createElement(yt.a,{className:"moveRow",key:"".concat(t.url),onClick:e.props.launchGame(t.url)},p.a.createElement(Et.a,null,"1-0"===t.result?p.a.createElement("b",null,a):a," ",t.result," ","0-1"===t.result?p.a.createElement("b",null,n):n))}))))}},{key:"player",value:function(e,t){return"".concat(e,"(").concat(t,")")}},{key:"getPopover",value:function(e){var t=this.state.openPerformanceIndex===e,a=this.props.movesToShow[e];return p.a.createElement(gt.a,{trigger:"hover",placement:"right",isOpen:t,target:"performancePopover".concat(e),toggle:this.togglePerformancePopover(e)},p.a.createElement(kt,{moveDetails:a.details,simplifiedView:!0,isOpen:t,launchGame:this.props.launchGame,settings:this.props.settings}))}},{key:"movesTable",value:function(){var e=this,t=this.props.movesToShow&&this.props.movesToShow.length>0;return p.a.createElement(vt.a,null,t?p.a.createElement(wt.a,null,p.a.createElement(yt.a,null,p.a.createElement(Et.a,{size:"small",className:"smallCol"},p.a.createElement("b",null,"Move")),p.a.createElement(Et.a,{size:"small",className:"smallCol"},p.a.createElement("b",null,"Games")),p.a.createElement(Et.a,null,p.a.createElement("b",null,"Results")))):null,t?p.a.createElement(bt.a,null,this.props.movesToShow.map((function(t,a){var n=e.player(t.details.lastPlayedGame.white,t.details.lastPlayedGame.whiteElo),s=e.player(t.details.lastPlayedGame.black,t.details.lastPlayedGame.blackElo),r=t.details.lastPlayedGame.result;return t.details.count>1?p.a.createElement(yt.a,{className:"moveRow",key:"".concat(t.orig).concat(t.dest),onClick:e.move(t.orig,t.dest)},p.a.createElement(Et.a,{size:"small",className:"smallCol"},t.san," "),p.a.createElement(Et.a,{size:"small",id:"performancePopover".concat(a),className:"smallCol",onClick:e.togglePerformancePopover(a)},t.details.count," ",p.a.createElement(Y.a,{className:"lowOpacity",icon:Q.h}),e.getPopover(a)),p.a.createElement(Et.a,null,p.a.createElement(ft.a,{className:"border",multi:!0},p.a.createElement(ft.a,{bar:!0,className:"whiteMove",value:"".concat(t.details.whiteWins/t.details.count*100)},t.details.whiteWins/t.details.count>.1?t.details.whiteWins:""),p.a.createElement(ft.a,{bar:!0,className:"grayMove",value:"".concat(t.details.draws/t.details.count*100)},t.details.draws/t.details.count>.1?t.details.draws:""),p.a.createElement(ft.a,{bar:!0,className:"blackMove",value:"".concat(t.details.blackWins/t.details.count*100)},t.details.blackWins/t.details.count>.1?t.details.blackWins:"")))):p.a.createElement(yt.a,{className:"moveRow",key:"".concat(t.orig).concat(t.dest),onClick:e.move(t.orig,t.dest)},p.a.createElement(Et.a,{size:"small",className:"smallCol"},t.san),p.a.createElement(Et.a,{colSpan:"2"},n," ",r," ",s," ",p.a.createElement(Y.a,{className:"pointerExternalLink",onClick:e.props.launchGame(t.details.lastPlayedGame.url),icon:Q.f})))}))):null,p.a.createElement(Ct.a,null,p.a.createElement(yt.a,null,t?p.a.createElement(Et.a,{colSpan:"3"},"Showing moves that have been played ",this.props.turnColor===this.props.settings.playerColor?"by":"by others against"," ",p.a.createElement("b",null,this.props.settings.playerName)," in this position. ",p.a.createElement("b",null,this.props.settings.playerName)," is playing as ",p.a.createElement("b",null,this.props.settings.playerColor),"."):p.a.createElement(Et.a,{colSpan:"3"},"No moves found in this position played ",this.props.turnColor===this.props.settings.playerColor?"by":"by others against"," ",p.a.createElement("b",null,this.props.settings.playerName)," in this position. ",p.a.createElement("b",null,this.props.settings.playerName)," is playing as ",p.a.createElement("b",null,this.props.settings.playerColor),"."))))}}]),t}(p.a.Component),Ot=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={activeTab:"user"},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"launchGame",value:function(e){return function(t){t.stopPropagation(),window.open(e,"_blank"),J("moves","ViewGameExternal")}}},{key:"toggle",value:function(e){this.state.activeTab!==e&&(this.setState({activeTab:e}),J("controls","activeTab:".concat(e)))}},{key:"switchToUserTab",value:function(){this.toggle("user")}},{key:"switchToMovesTab",value:function(){this.toggle("moves")}},{key:"render",value:function(){var e=this;return p.a.createElement("div",null,p.a.createElement(te.a,{tabs:!0},p.a.createElement(ct.a,null,p.a.createElement(ut.a,{className:dt()({active:"user"===this.state.activeTab}),onClick:function(){e.toggle("user")}},p.a.createElement(Y.a,{icon:Q.n})," ","user"===this.state.activeTab?"User":"")),p.a.createElement(ct.a,null,p.a.createElement(ut.a,{className:dt()({active:"moves"===this.state.activeTab}),onClick:function(){e.toggle("moves")}},p.a.createElement(Y.a,{icon:Q.i})," ","moves"===this.state.activeTab?"Moves":"")),p.a.createElement(ct.a,null,p.a.createElement(ut.a,{className:dt()({active:"report"===this.state.activeTab}),onClick:function(){e.toggle("report")}},p.a.createElement(Y.a,{icon:Q.c})," ","report"===this.state.activeTab?"Report":"")),p.a.createElement(ct.a,null,p.a.createElement(ut.a,{className:dt()({active:"settings"===this.state.activeTab}),onClick:function(){e.toggle("settings")}},p.a.createElement(Y.a,{icon:Q.d})," ","settings"===this.state.activeTab?"Controls":""))),p.a.createElement(ht.a,{activeTab:this.state.activeTab},p.a.createElement(mt.a,{tabId:"user"},p.a.createElement(it,{switchToMovesTab:this.switchToMovesTab.bind(this),clear:this.props.clear,gamesProcessed:this.props.gamesProcessed,settings:this.props.settings,onChange:this.props.settingsChange,notify:this.props.updateProcessedGames,showError:this.props.showError,setDownloading:this.props.setDownloading,isDownloading:this.props.isDownloading})),p.a.createElement(mt.a,{tabId:"moves"},p.a.createElement(Nt,{switchToUserTab:this.switchToUserTab.bind(this),movesToShow:this.props.movesToShow,gameResults:this.props.gameResults,onMove:this.props.onMove,settings:this.props.settings,turnColor:this.props.turnColor,settingsChange:this.props.settingsChange,launchGame:this.launchGame})),p.a.createElement(mt.a,{tabId:"report"},p.a.createElement(kt,{fen:this.props.fen,simplifiedView:!1,moveDetails:this.props.openingGraph.getDetailsForFen(this.props.fen),launchGame:this.launchGame,settings:this.props.settings,switchToUserTab:this.switchToUserTab.bind(this),isOpen:"report"===this.state.activeTab,showInfo:this.props.showInfo})),p.a.createElement(mt.a,{tabId:"settings"},p.a.createElement(U.a,null,p.a.createElement(_.a,{sm:"6"},p.a.createElement(lt,{fen:this.props.fen,settings:this.props.settings,isOpen:!0,clear:this.props.clear,reset:this.props.reset,onChange:this.props.settingsChange}))))))}}]),t}(p.a.Component);function St(){return"w"===this.chess.turn()?"white":"black"}function Ft(){return this.state.settings.playerColor}function Tt(){return this.playerColor()===this.turnColor()?this.forBrushes:this.againstBrushes}function Pt(){var e=this,t={};return this.chess.SQUARES.forEach((function(a){var n=e.chess.moves({square:a,verbose:!0});n.length&&(t[a]=n.map((function(e){return e.to})))})),{free:!1,dests:t,color:this.turnColor()}}function xt(){return this.state.settings.orientation}function jt(e,t){var a=this.chess,n=a.move({from:e,to:t,promotion:"q"});this.setState({fen:a.fen(),lastMove:n})}function Rt(e,t){this.onMove(e,t),J("chessboard","Move")}function At(e,t){this.chess=new g.a(e),this.setState({fen:e,lastMove:t})}function Mt(e,t,a){var n=this.state.gamesProcessed+t;return this.setState({gamesProcessed:n,openingGraph:a,downloadingGames:(n<e||e>=2e3)&&this.state.downloadingGames}),(n<e||e>=2e3)&&this.state.downloadingGames}function Gt(e){return{orig:e.orig,dest:e.dest,brush:this.brushes()[e.level]}}function Dt(){var e=this.movesToShow();if(e){var t=e.map(this.moveToShape.bind(this));return this.fillArray(t,25)}return this.fillArray([],25)}function Lt(){var e=this.state.openingGraph.movesForFen(this.chess.fen());return e?e.sort((function(e,t){return t.details.count-e.details.count})):e}function Bt(){return this.state.openingGraph.gameResultsForFen(this.chess.fen())}function It(e,t){for(var a=e.length;a<t;a++)e.push({orig:"i"+a,dest:"i"+(a+1),brush:this.brushes()[0]});return e}function Wt(){this.chess=new g.a,this.setState({fen:this.chess.fen(),lastMove:null})}function zt(){this.state.openingGraph.clear(),this.state.gamesProcessed=0,this.reset()}function Ut(e,t){var a=this.state.settings;a[e]=t,this.setState({settings:a})}function _t(e,t){this.setState({message:e,messageSeverity:"warning"}),J("error","errorShown",t||e)}function Vt(e,t){this.setState({message:e,messageSeverity:"success"}),J("error","infoShown",t||e)}function Yt(){this.setState({message:""})}function Qt(e){this.setState({downloadingGames:e})}var qt=a(685),Jt=a(676),Kt=function(e){function t(e){var a,n;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).chess=new g.a,(n=Object(u.a)(a)).orientation=xt,n.turnColor=St,n.calcMovable=Pt,n.onMove=jt,n.onMoveAction=Rt,n.autoShapes=Dt,n.updateProcessedGames=Mt,n.settingsChange=Ut,n.reset=Wt,n.clear=zt,n.navigateTo=At,n.playerColor=Ft,n.fillArray=It,n.brushes=Tt,n.moveToShape=Gt,n.movesToShow=Lt,n.gameResults=Bt,n.showError=_t,n.showInfo=Vt,n.closeError=Yt,n.setDownloading=Qt,a.state={fen:a.chess.fen(),lastMove:null,gamesProcessed:0,openingGraph:D,settings:{playerName:"",orientation:"white",playerColor:"white"},message:"",downloadingGames:!1},a.chessboardWidth=a.getChessboardWidth(),a.forBrushes=["paleGrey","paleGreen","green"],a.againstBrushes=["paleRed","paleRed","red"],a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getChessboardWidth",value:function(){return window.innerWidth<=768?"".concat(Math.round(95*window.innerWidth/100),"px"):window.innerWidth<=1024?"".concat(Math.round(40*window.innerWidth/100),"px"):"512px"}},{key:"render",value:function(){var e=this.state.lastMove?[this.state.lastMove.from,this.state.lastMove.to]:null,t=!!this.state.message;return p.a.createElement("div",{className:"rootView"},p.a.createElement(he,null),p.a.createElement(z.a,{className:"mainContainer"},p.a.createElement(U.a,null,p.a.createElement(_.a,{lg:{order:0,size:2},xs:{order:2}},p.a.createElement(K,{fen:this.state.fen,move:this.state.lastMove,onChange:this.navigateTo.bind(this)})),p.a.createElement(_.a,{lg:"6"},p.a.createElement(v.a,{height:this.chessboardWidth,width:this.chessboardWidth,orientation:this.orientation(),turnColor:this.turnColor(),movable:this.calcMovable(),lastMove:e,fen:this.state.fen,onMove:this.onMoveAction.bind(this),drawable:{enabled:!0,visible:!0,autoShapes:this.autoShapes()},style:{margin:"auto"}})),p.a.createElement(_.a,{lg:"4",className:"paddingTop"},p.a.createElement(Ot,{fen:this.state.fen,gamesProcessed:this.state.gamesProcessed,updateProcessedGames:this.updateProcessedGames.bind(this),settingsChange:this.settingsChange.bind(this),settings:this.state.settings,reset:this.reset.bind(this),clear:this.clear.bind(this),movesToShow:this.movesToShow(),gameResults:this.gameResults(),onMove:this.onMove.bind(this),turnColor:this.turnColor(),showError:this.showError.bind(this),showInfo:this.showInfo.bind(this),setDownloading:this.setDownloading.bind(this),isDownloading:this.state.downloadingGames,openingGraph:this.state.openingGraph})))),p.a.createElement(qt.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t,autoHideDuration:6e3,onClose:this.closeError.bind(this)},p.a.createElement(Jt.a,{onClose:this.closeError.bind(this),severity:this.state.messageSeverity},this.state.message)))}}]),t}(p.a.Component);r.a.render(p.a.createElement(Kt,null),document.getElementById("root")),q.a.pageview(window.location.pathname)},99:function(e,t,a){"use strict";function n(e,t,a,s){this.message=e,this.expected=t,this.found=a,this.location=s,this.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(e,t){function a(){this.constructor=e}a.prototype=t.prototype,e.prototype=new a}(n,Error),n.buildMessage=function(e,t){var a={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t,a="";for(t=0;t<e.parts.length;t++)a+=e.parts[t]instanceof Array?r(e.parts[t][0])+"-"+r(e.parts[t][1]):r(e.parts[t]);return"["+(e.inverted?"^":"")+a+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function r(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,s,r=new Array(e.length);for(t=0;t<e.length;t++)r[t]=(s=e[t],a[s.type](s));if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:n,parse:function(e,t){t=void 0!==t?t:{};var a,s={},r={start:be},o=be,i=function(e,t,a){return function(e,t,a,n){return{headers:(e=e||[]).reduce((function(e,t){return Object.assign(e,t)}),{}),comment:t,moves:a||[],result:n}}(e,t,a[0],a[1])},l={type:"any"},c=me('"',!1),u=/^[^"]/,h=pe(['"'],!0,!1),m=/^[1-9]/,p=pe([["1","9"]],!1,!1),d=/^[0-9]/,g=pe([["0","9"]],!1,!1),f=/^[A-Za-z0-9_\-]/,v=pe([["A","Z"],["a","z"],["0","9"],"_","-"],!1,!1),b=function(e){return e.join("")},y=me(" ",!1),E=me("\f",!1),w=me("\t",!1),C=me("\n",!1),k=me("[",!1),N=me("]",!1),O=/^[NKQRBP]/,S=pe(["N","K","Q","R","B","P"],!1,!1),F=/^[a-h]/,T=pe([["a","h"]],!1,!1),P=/^[1-8]/,x=pe([["1","8"]],!1,!1),j=me("+",!1),R=me("#",!1),A=/^[x@]/,M=pe(["x","@"],!1,!1),G=me(".",!1),D=me("1-0",!1),L=me("0-1",!1),B=me("*",!1),I=me("1/2-1/2",!1),W=me("=",!1),z=/^[QRBNK]/,U=pe(["Q","R","B","N","K"],!1,!1),_=me("$",!1),V=me("!!",!1),Y=me("??",!1),Q=me("!?",!1),q=me("?!",!1),J=me("!",!1),K=me("?",!1),H=/^[^}]/,$=pe(["}"],!0,!1),Z=me("{",!1),X=me("}",!1),ee=me("O-O-O",!1),te=me("O-O",!1),ae=function(e){return function e(t){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0;n<t.length;n++)Array.isArray(t[n])?e(t[n],a):a.push(t[n]);return a}(e).join("")},ne=function(e,t,a){return a},se=function(e,t,a,n,s){return s},re=me("(",!1),oe=me(")",!1),ie=0,le=[{line:1,column:1}],ce=0,ue=[],he=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=r[t.startRule]}function me(e,t){return{type:"literal",text:e,ignoreCase:t}}function pe(e,t,a){return{type:"class",parts:e,inverted:t,ignoreCase:a}}function de(t){var a,n=le[t];if(n)return n;for(a=t-1;!le[a];)a--;for(n={line:(n=le[a]).line,column:n.column};a<t;)10===e.charCodeAt(a)?(n.line++,n.column=1):n.column++,a++;return le[t]=n,n}function ge(e,t){var a=de(e),n=de(t);return{start:{offset:e,line:a.line,column:a.column},end:{offset:t,line:n.line,column:n.column}}}function fe(e){ie<ce||(ie>ce&&(ce=ie,ue=[]),ue.push(e))}function ve(e,t,a){return new n(n.buildMessage(e,t),e,t,a)}function be(){var t,a,n,r,o,i;if(t=ie,a=[],n=ie,(r=ye())!==s){for(o=[],i=Ne();i!==s;)o.push(i),i=Ne();o!==s?n=r=[r,o]:(ie=n,n=s)}else ie=n,n=s;for(;n!==s;)if(a.push(n),n=ie,(r=ye())!==s){for(o=[],i=Ne();i!==s;)o.push(i),i=Ne();o!==s?n=r=[r,o]:(ie=n,n=s)}else ie=n,n=s;return a!==s&&(n=function(){var t,a;t=ie,he++,e.length>ie?(a=e.charAt(ie),ie++):(a=s,0===he&&fe(l));he--,a===s?t=void 0:(ie=t,t=s);return t}())!==s?(t,t=a=a.map((function(e){return e[0]}))):(ie=t,t=s),t}function ye(){var e,t,a,n,r,o,l,c;if(e=ie,(t=function(){var e,t,a;if(e=ie,t=[],(a=Oe())!==s)for(;a!==s;)t.push(a),a=Oe();else t=s;t!==s&&(e,t=t);return e=t}())===s&&(t=null),t!==s)if((a=Ge())===s&&(a=null),a!==s){for(n=[],r=ke();r!==s;)n.push(r),r=ke();if(n!==s){if(r=ie,(o=Ie())!==s){if(l=[],(c=ke())!==s)for(;c!==s;)l.push(c),c=ke();else l=s;l!==s&&(c=je())!==s?(r,r=o=[o,c]):(ie=r,r=s)}else ie=r,r=s;if(r===s&&(r=ie,(o=je())!==s&&(r,o=function(e,t,a){return[null,a]}(0,0,o)),r=o),r!==s){for(o=[],l=ke();l!==s;)o.push(l),l=ke();o!==s?(e,e=t=i(t,a,r)):(ie=e,e=s)}else ie=e,e=s}else ie=e,e=s}else ie=e,e=s;else ie=e,e=s;return e}function Ee(){var t;return 34===e.charCodeAt(ie)?(t='"',ie++):(t=s,0===he&&fe(c)),t}function we(){var t,a,n,r;if(t=ie,m.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=s,0===he&&fe(p)),a!==s){for(n=[],d.test(e.charAt(ie))?(r=e.charAt(ie),ie++):(r=s,0===he&&fe(g));r!==s;)n.push(r),d.test(e.charAt(ie))?(r=e.charAt(ie),ie++):(r=s,0===he&&fe(g));n!==s?(t,t=a=parseInt(a+n.join(""),10)):(ie=t,t=s)}else ie=t,t=s;return t}function Ce(){var t;return 32===e.charCodeAt(ie)?(t=" ",ie++):(t=s,0===he&&fe(y)),t===s&&(12===e.charCodeAt(ie)?(t="\f",ie++):(t=s,0===he&&fe(E)),t===s&&(9===e.charCodeAt(ie)?(t="\t",ie++):(t=s,0===he&&fe(w)))),t}function ke(){var e;return(e=Ce())===s&&(e=Ne()),e}function Ne(){var t;return 10===e.charCodeAt(ie)?(t="\n",ie++):(t=s,0===he&&fe(C)),t}function Oe(){var t,a,n,r,o,i,l,c;if(t=ie,91===e.charCodeAt(ie)?(a="[",ie++):(a=s,0===he&&fe(k)),a!==s)if((n=function(){var t,a,n;if(t=ie,a=[],f.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=s,0===he&&fe(v)),n!==s)for(;n!==s;)a.push(n),f.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=s,0===he&&fe(v));else a=s;return a!==s&&(t,a=b(a)),t=a}())!==s){if(r=[],(o=Ce())!==s)for(;o!==s;)r.push(o),o=Ce();else r=s;if(r!==s)if((o=function(){var t,a,n;if(t=ie,Ee()!==s){for(a=[],u.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=s,0===he&&fe(h));n!==s;)a.push(n),u.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=s,0===he&&fe(h));a!==s&&(n=Ee())!==s?(t,t=a.join("")):(ie=t,t=s)}else ie=t,t=s;return t}())!==s)if(93===e.charCodeAt(ie)?(i="]",ie++):(i=s,0===he&&fe(N)),i!==s){for(l=[],c=ke();c!==s;)l.push(c),c=ke();l!==s?(t,t=a=function(e,t){var a={};return a[e]=t,a}(n,o)):(ie=t,t=s)}else ie=t,t=s;else ie=t,t=s;else ie=t,t=s}else ie=t,t=s;else ie=t,t=s;return t}function Se(){var t;return O.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=s,0===he&&fe(S)),t}function Fe(){var t;return F.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=s,0===he&&fe(T)),t}function Te(){var t;return P.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=s,0===he&&fe(x)),t}function Pe(){var t;return A.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=s,0===he&&fe(M)),t}function xe(){var t;return 46===e.charCodeAt(ie)?(t=".",ie++):(t=s,0===he&&fe(G)),t}function je(){var t;return"1-0"===e.substr(ie,3)?(t="1-0",ie+=3):(t=s,0===he&&fe(D)),t===s&&("0-1"===e.substr(ie,3)?(t="0-1",ie+=3):(t=s,0===he&&fe(L)),t===s&&(42===e.charCodeAt(ie)?(t="*",ie++):(t=s,0===he&&fe(B)),t===s&&("1/2-1/2"===e.substr(ie,7)?(t="1/2-1/2",ie+=7):(t=s,0===he&&fe(I))))),t}function Re(){var e,t,a;return e=ie,(t=Fe())!==s&&(a=Te())!==s?(e,e=t=t+a):(ie=e,e=s),e}function Ae(){var t,a,n,r;return t=ie,a=ie,36===e.charCodeAt(ie)?(n="$",ie++):(n=s,0===he&&fe(_)),n!==s&&(r=we())!==s?a=n=[n,r]:(ie=a,a=s),a!==s&&(t,a=b(a)),t=a}function Me(){var t;return H.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=s,0===he&&fe($)),t}function Ge(){var t,a,n,r;if(t=ie,123===e.charCodeAt(ie)?(a="{",ie++):(a=s,0===he&&fe(Z)),a!==s){for(n=[],r=Me();r!==s;)n.push(r),r=Me();n!==s?(125===e.charCodeAt(ie)?(r="}",ie++):(r=s,0===he&&fe(X)),r!==s?(t,t=a=n.join("")):(ie=t,t=s)):(ie=t,t=s)}else ie=t,t=s;return t}function De(){var t,a,n,r;return t=ie,a=ie,(n=Fe())!==s&&(r=Pe())!==s?a=n=[n,r]:(ie=a,a=s),a===s&&(a=null),a!==s&&(n=Re())!==s?((r=function(){var t,a,n;return t=ie,61===e.charCodeAt(ie)?(a="=",ie++):(a=s,0===he&&fe(W)),a!==s?(z.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=s,0===he&&fe(U)),n!==s?t=a=[a,n]:(ie=t,t=s)):(ie=t,t=s),t}())===s&&(r=null),r!==s?t=a=[a,n,r]:(ie=t,t=s)):(ie=t,t=s),t}function Le(){var t,a,n,r,o,i;return t=ie,a=ie,(n=function(){var e,t,a,n;return e=ie,(t=xe())!==s&&(a=xe())!==s&&(n=xe())!==s?e=t=[t,a,n]:(ie=e,e=s),e}())===s&&(n=null),n!==s?((r=function(){var t;return"O-O-O"===e.substr(ie,5)?(t="O-O-O",ie+=5):(t=s,0===he&&fe(ee)),t===s&&("O-O"===e.substr(ie,3)?(t="O-O",ie+=3):(t=s,0===he&&fe(te))),t}())===s&&(r=function(){var e,t,a,n,r;return e=ie,(t=Se())!==s?((a=Fe())===s&&(a=Te()),a!==s?((n=Pe())===s&&(n=null),n!==s&&(r=Re())!==s?e=t=[t,a,n,r]:(ie=e,e=s)):(ie=e,e=s)):(ie=e,e=s),e}())===s&&(r=function(){var e,t,a,n;return e=ie,(t=Se())!==s?((a=Pe())===s&&(a=null),a!==s&&(n=Re())!==s?e=t=[t,a,n]:(ie=e,e=s)):(ie=e,e=s),e}())===s&&(r=De()),r!==s?((o=function(){var t;return 43===e.charCodeAt(ie)?(t="+",ie++):(t=s,0===he&&fe(j)),t}())===s&&(o=function(){var t;return 35===e.charCodeAt(ie)?(t="#",ie++):(t=s,0===he&&fe(R)),t}()),o===s&&(o=null),o!==s?((i=function(){var t;return"!!"===e.substr(ie,2)?(t="!!",ie+=2):(t=s,0===he&&fe(V)),t===s&&("??"===e.substr(ie,2)?(t="??",ie+=2):(t=s,0===he&&fe(Y)),t===s&&("!?"===e.substr(ie,2)?(t="!?",ie+=2):(t=s,0===he&&fe(Q)),t===s&&("?!"===e.substr(ie,2)?(t="?!",ie+=2):(t=s,0===he&&fe(q)),t===s&&(33===e.charCodeAt(ie)?(t="!",ie++):(t=s,0===he&&fe(J)),t===s&&(63===e.charCodeAt(ie)?(t="?",ie++):(t=s,0===he&&fe(K))))))),t}())===s&&(i=null),i!==s?a=n=[n,r,o,i]:(ie=a,a=s)):(ie=a,a=s)):(ie=a,a=s)):(ie=a,a=s),a!==s&&(t,a=ae(a)),t=a}function Be(){var e,t,a,n,r,o,i,l,c,u;if(e=ie,(t=function(){var e,t,a,n,r,o;return e=ie,(t=we())!==s?((a=xe())===s&&(a=null),a!==s?(n=ie,(r=xe())!==s&&(o=xe())!==s?n=r=[r,o]:(ie=n,n=s),n===s&&(n=null),n!==s?(e,e=t=t):(ie=e,e=s)):(ie=e,e=s)):(ie=e,e=s),e}())===s&&(t=null),t!==s){for(a=[],n=ke();n!==s;)a.push(n),n=ke();if(a!==s)if((n=Le())!==s){if(r=[],o=ie,i=[],(l=ke())!==s)for(;l!==s;)i.push(l),l=ke();else i=s;for(i!==s&&(l=Ae())!==s?(o,o=i=ne(0,0,l)):(ie=o,o=s);o!==s;){if(r.push(o),o=ie,i=[],(l=ke())!==s)for(;l!==s;)i.push(l),l=ke();else i=s;i!==s&&(l=Ae())!==s?(o,o=i=ne(0,0,l)):(ie=o,o=s)}if(r!==s){if(o=ie,i=[],(l=ke())!==s)for(;l!==s;)i.push(l),l=ke();else i=s;if(i!==s&&(l=Ge())!==s?(o,o=i=l):(ie=o,o=s),o===s&&(o=null),o!==s){if(i=[],l=ie,c=[],(u=ke())!==s)for(;u!==s;)c.push(u),u=ke();else c=s;for(c!==s&&(u=We())!==s?(l,l=c=se(0,0,0,0,u)):(ie=l,l=s);l!==s;){if(i.push(l),l=ie,c=[],(u=ke())!==s)for(;u!==s;)c.push(u),u=ke();else c=s;c!==s&&(u=We())!==s?(l,l=c=se(0,0,0,0,u)):(ie=l,l=s)}i!==s?(e,e=t=function(e,t,a,n,s){var r={};return e&&(r.move_number=e),t&&(r.move=t),a&&a.length&&(r.nags=a),n&&n.length&&(r.ravs=n),s&&(r.comment=s),r}(t,n,r,i,o)):(ie=e,e=s)}else ie=e,e=s}else ie=e,e=s}else ie=e,e=s;else ie=e,e=s}else ie=e,e=s;return e}function Ie(){var e,t,a,n,r,o,i,l;if(e=ie,(t=Be())!==s){if(a=[],n=ie,r=[],(o=ke())!==s)for(;o!==s;)r.push(o),o=ke();else r=s;for(r!==s&&(o=Be())!==s?n=r=[r,o]:(ie=n,n=s);n!==s;){if(a.push(n),n=ie,r=[],(o=ke())!==s)for(;o!==s;)r.push(o),o=ke();else r=s;r!==s&&(o=Be())!==s?n=r=[r,o]:(ie=n,n=s)}a!==s?(e,l=a,e=t=(i=t)?[i].concat(l.map((function(e){return e[1]}))):[]):(ie=e,e=s)}else ie=e,e=s;return e}function We(){var t,a,n,r,o,i,l,c;if(t=ie,40===e.charCodeAt(ie)?(a="(",ie++):(a=s,0===he&&fe(re)),a!==s){for(n=[],r=ke();r!==s;)n.push(r),r=ke();if(n!==s)if((r=Ie())!==s){for(o=[],i=ke();i!==s;)o.push(i),i=ke();if(o!==s)if((i=je())===s&&(i=null),i!==s){for(l=[],c=ke();c!==s;)l.push(c),c=ke();l!==s?(41===e.charCodeAt(ie)?(c=")",ie++):(c=s,0===he&&fe(oe)),c!==s?(t,t=a={moves:r,result:i}):(ie=t,t=s)):(ie=t,t=s)}else ie=t,t=s;else ie=t,t=s}else ie=t,t=s;else ie=t,t=s}else ie=t,t=s;return t}if((a=o())!==s&&ie===e.length)return a;throw a!==s&&ie<e.length&&fe({type:"end"}),ve(ue,ce<e.length?e.charAt(ce):null,ce<e.length?ge(ce,ce+1):ge(ce,ce))}}}},[[316,1,2]]]);
//# sourceMappingURL=main.baa59194.chunk.js.map